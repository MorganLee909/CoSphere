<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8"/>
        <meta name="viewport" content="width=device.width, initial-scale=1.0"/>
        <title>Checkout | CoSphere </title>
        <script src="https://js.stripe.com/v3"></script>
    </head>
    <body>
        <div id="checkout"></div>

        <script>
            const stripe = Stripe("pk_test_51On6e4I8NTnuAPIlJJ7OdF4l1kUGMnT7VR2dRO7SHpgOwXInG0p4WOUsywilPtDpMv73fLLhKvALqG30Q1plK21500E9mevMM3");

            fetch("/stripe/checkout-session", {
                method: "get",
                headers: {
                    "Content-Type": "application/json"
                }
            })
                .then(r=>r.json())
                .then((response)=>{
                    if(response.error === true){
                        console.log(response);
                    }else{
                        return stripe.initEmbeddedCheckout({clientSecret: response});
                    }
                })
                .then((checkout)=>{
                    checkout.mount("#checkout");
                })
                .catch((err)=>{
                    console.log(err);
                });
        </script>
    </body>
</html>
